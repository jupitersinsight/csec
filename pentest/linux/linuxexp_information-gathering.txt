Enumerating NFS.
-----------------

Ports involved: TCP 111,2049.

NFS Exports are what administrators use for folder sharing.
Misconfigured exports, configured in file at /etc/exports, could allow access from any IP addresses with no
restrictions nor authentication.

nfs-ls, nfs-showmount, nfs-statfs are nmap NSE scripts useful for NFS enumeration.
In the output, the attacker can see which IP Addresses can connect to "exports".
Either whitelisted IP Address, spoofable, or no whltelist, "*", NFS are insecure.

NFS mount example:
. mount -t nfs [NFS SERVER IP]:[EXPORT] /mnt/[DIR] -o noclock


Enumerating SMB (Samba).
-------------------------

Ports involved: TCP 137-139,445

There are lots of tools for SMB enumeration and exploitation.
As usual, Nmap does include scripts useful against SMB.
--script smb-enum-shares [IPADDRESS_TARGET]: lists shares and other information (users used to access the shares,
		Samba Version and OS, Shares and access rights, Anonymous access allowed).

smbclient -l [IPADDRESS_TARGET]: lists information about SMB shares

smbmap -H [IPADDRESS_TARGET]: lists shares and read/write permissions

smbclient [PATH_TO_SMBSHARE]: connect to remote share

Another way to browse SMB shares is to mount them as connected shares.
Example: mount -t cifs [PATH_TO_SMBSHARE] [PATH_TO_MOUNTPOINT]

After enumerating shares, one important step is to enumerate users.
One manual process involves using rpcclient and bash forloops command.
Esample:
for u in $(cat [USERNAMES_LIST].txt); do rpcclient -U "" [TARGET_IPADDRESS] -N \ --command="lookupnames $u"; done | grep "User: 1"

-U "": anonymous login
-N: no password required because on target machine/smb shares guest access is allowed

Existing users are flagged with "User: 1" statement.

Automatic users smb users enumeration can be achieved through enum4linux.

Enumerating SMTP.
-----------------

Ports involved: TCP 25.

The following techniques apply to a wide range of SMTP engines like Sendmail, Postfix, Exim and Microsoft Exchange.

The first step tries to find which commands (verbs) are available on target SMTP server.

nmap --script smtp-commands [TARGET_IPADDRESS] -p 25

telnet/nc to port 25: "help" command on server results in a response which contains a list of enabled features/verbs.

RCPT, EXPN and VRFY are verbs useful for enumeration.

#1:
. telnet/nc into SMTP server
. "HELO tester.localdomain" provides the SMTP server with a domain name
. "MAIL FROM tester@tester.localdomain" provides the SMTP server with a sender e-mail
. "RCPT TO [usertoenumerate]@[domainnametoenumerate]" existing users return "Status code 250 2.1.5"

#2:
. telnet/nc into SMTP Server
. "EXPN [usertoenumerate]" returns whether a user exists or not. EXPN was designed to be used for query mail server for a list of members
		within a mailing list on a server.

#3:
. telnet/nc into SMTP Server
. "VRFY [usertoenumerate]" returns whether a user exists or not.

smtp-user-enum by pentestmonkey is a tool which automates the above manual enumerating processes.


