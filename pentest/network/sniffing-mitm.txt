Sniffing
---------

Passive sniffing means the attacker simply listens to network traffic in the hope of intercept useful informatin such as
userids and passwords. The only tool needed is a network sniffer like Wireshark or TCPdump.

Active sniffing means the attacker actively tries to manipulate the traffic on the network to intercept it.
Different techniques can be used like MAC flooding and ARP poisoning.

A MAC flooding attack aims at stressing a switch filling its CAM table with MAC Addresses.
By design, when a CAM table is full, switches enter a "fail open" mode. While in this mode every packet received is flooded
to each port, basically breadcasting all packets.

ARP poisoning is more stealthy than MAC flooding since it aims at redirecting the traffic without attacking devices.
The attacker, by sending unsolicited ARP messages (called gratuitous ARPs), pretends to be another device on the network like a gateway.

ARP poisong comes in two forms:
- Host poisoning: the attacker sends gratuitous ARP messages to target hosts in order to place himself in the middle of the 
    communication
- Gateway poisoning: the attacker sends gratuitous ARP messages to all devices on the network placing himself between LAN and WAN (acting as a Gateway, or Default Gateway) intercepting all traffic passing through. The attacker machine must be 
very quick to forward intercepted traffic to the real gateway in order to not cause a Denial of Service on Local Network.

In Windows environment attackers can take advantage of some Windows features like LLMNR and NBT-NS.
Link Local Multicast Name Resolution was introduced from Windows Vista and is to be considered the successor of 
NetBIOS Name Service.
These features kick in when Windows fails to resolve hostnames due to missing DNS or DNS not responding/failing.
LLMNR and NBT-NS messages are broadcast packets that tools like Responder can intercept.
Since these messages carry NTLMNv1/v2 hashes, if an attacker intercept them can mount pass-the-hash attacks or crack
them offline.

Tools like Responder can listen on specified interfaces and intercept this kind of traffic.
In order to exploit SMB pass-the-hash vulnerabilities, SMB-Signing feature must be disabled on target host.
Responder does include a tool, RunFinger.py, useful to check it (invoke command : python RunFinger.py -i [TARGET_IP])

In order to conduct a "Responder/MultiRelay" attack:
- Modify the Responder.conf file and disable "SMB" and "HTTP" server options (value to "Off")
- python Responder.py -I [LISTENING INTERFACE] --lm (--lm tries to downgrade NTLMv2 to v1)
- python MultiRelay.py -t [TARGET] -u ALL

A successful hash relay will spwan a MultiRelay shell from which an attacker can launch built-in commands or other 
tools/commands.
