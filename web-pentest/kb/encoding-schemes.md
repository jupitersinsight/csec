## Encoding Schemes

Encoding schemes are needed to let HTTP and HTML to safely handle unusual character and binary data.  
While attacking a web applications, encoding data using a relevant scheme ensures that it is handled in the way the attacker intended.  
Furthermore, in many cases, it is possible to manipulate the encoding schemes an application uses to cause behavior not intended by the application's designers.  

### URL Encoding

URLs are permitted to contain only the printable characters in the [US-ASCII character set](http://www.columbia.edu/kermit/ascii.html) (ASCII code in the range between 0x20 to 0x7e inclusive, minus several characters within this range because they have special meaning within the URL scheme itself or within the HTTP protocol).  

The URL-encoding scheme is used to encode any problematic characters within the [extended ASCII charset](https://www.lookuptables.com/text/extended-ascii-table) so that they can be safely transported over HTTP. 

The URL-encoded representation of any character is formed by a prefix (%) and the two-digit's ASCII code expressed in hexadecimal, like:
- %3d -> =
- %25 -> %
- %20 (or +) -> [space]
- %0a -> [line feed] LF
- %00 -> [null byte] NUL
- %0d -> [carriage return] CR

When attacking a web application the following characters should be URL-encoded when treated _as data_ (in their literal form when used as concatenator to add paramater in a request) in an HTTP request:
- [space]
- ?
- &
- =
- ;
- \+
- \#

### Unicode Encoding

Unicode is a character encoding standard designed to support all of the world's writing systems. It employs various encoding schemes, some of which can be used to represent unusual characters in web applications.  

16-bit unicode encoding works similar to URL-encoding, examples:
- %u2215 -> /
- %u00e9 -> é

UTF-8 is a variable-length encoding standard that requires one or more bytes to express each character. For transmissions over HTTP, the UTF-8-encoded form of a multibyte character uses each byte expressed in hexadecimal with prefix %:
- %c2%a9 -> ©
- %e2%89%a0 ->  ≠

For the purpose of web hacking, the Unicode-encoding scheme may come in handy as bypass technique against input validation mechanisms: the filter may ignores encoded characters which would arrive to the back-end server that, if understands unicode-encoded characters, executes the payload.

### HTML Encoding

HTML-encoding scheme is used to represent problematic characters so that they can be safely incorporated into an HTML document. Various characters have special meaning as metacharacters within HTML and are used to define document's structure rather than its content.  
To use these characters safely as part of the document's content, they must be HTML-encoded, examples:

- \&quot; -> "
- \&apos; -> '
- \&amp; -> &
- \&lt; -> <
- \&gt; -> >

Any character can be HTML-encoded using its ASCII code:

- \&#34; -> "
- \&#39; -> '

Or using its ASCII code in hexadecimal format:

- \&#x22; -> "
- \&#27; -> '

HTML-encoding is especially useful while probing an application for XSS vulnerability: if an application returns user input unmodified within its responses, it is probably vulnerable, whereas if dangerous characters are HTML-encoded, it may be safe.

### Base64 Encoding

Base64 encoding allows any binary data to be safely represented using only printable ASCII characters.  

The encoding processes input data in blocks of three bytes. Each block is divided into four chunks of six bits each. Six bits of data allows for 64 different possible combinations, so each chunk can be represented using a set of 64 characters.  

>  1 block = 3 bytes = 24 bits  
1 block/4 = 6 bits  
bit is 0 or 1 -> 000000... 000001.... 000010  
2**6 = 64

If the final block of input data results in fewer than three chunks of output data, the output is padded with one or two = characters.  

### Hex Encoding

Many applications use hexadecimal encoding when transmit binary data, using ASCII characters to represent the hexadecimal block.  
For example, hex-encoding the username _daf_ within a cookie would result in: 646166