## HTML

Browsers and Web-Application Firewalls and other pieces of software might parse HTML in different ways and where this happens, there well might be a vulnerability.

HTML5 introduced default behaviors to follow for browsers when parsing legacy HTML code, examples are:
- the **script** tag on its own will automatically be closed at the end of the page
-  a tag missing its closing angle bracket will automatically be closed by the angle bracket of the next tag on the page


________

## SOP (Same-Origin Policy)

SOP is how the browser restricts a number of security-critical features:
- What domains can you contact via XMLHttpRequest
- Access the DOM across separate frames/windows

Some key features of Same-Origin Policy are:
- A page residing on one domain can cause and arbitrary request to be made to another domain (for example, by submitting a form or loading an image). But it cannot itself process tha data returned from that request.
- A page residing on one domain can load a script from another domain and execute this within its context. This is because scripts are assumed to contain code, rather than data, so cross-domain access should not lead to disclosure of any sensitive information.
- A page residing on one domain cannot read or modify the cookies or other DOM data belonging to another domain.

It prevents web applications from reading responses to requests between them.  
It does not prevent writing but reading.

### Origin Matching

The way origin matching for SOP works is much more strict than cookies:
- Protocol must match otherwise meaning there is no crossing HTTP/HTTPS boundaries
- Port numbers must match
- Domain names must be and exact match meaning wildcards and subdomain walking are not allowed

It is possible for developers to loosen the grip that SOP has on their communications by changing document.domain, posting messages between windows and by using CORS (Cross-Origin Resource Sharing).
Every little change opens up new avenues for attack.


________


## Bypassing Client-Side Controls  

Nowadays browsers and application roles have been heavily pumped up because leaving to them the loading of Javascript snippets and the processing of data which the server will (even though it should not) consider safe, helps in occupiyng less storage and increasing server-side performances.  
Moving important functions from the server to the client creates vulnerabilities because all that is client-side is under the user's control which bypass checks, alter data and manipulate information in order hack the system.  

### Hidden Form Fields

Applications may use hidden form fields to send predefined data to the server. These hidden fields are hard-coded into the HTML page.  
Using proxy-ready software to intercept the request and manipulating the value might trigger unwanted actions, such as buying products for low prices or even trigger refunds in case of negative value.  

### HTTP Cookies

Cookies can be used to transmit data, they are not visible to end-users but once intercepted attackers can modify them.  

### URL Parameters

URL parameters are not meant to be directly modified by users especially wehn embedded images are loaded, where parameters are used to load a frame's contents, where parameters are sent via POST method, where an application uses pop-up windows or other techniques to conceal the browser location bar.  

### The Referer Header

The Referer header indicates from which URL the request was originated from: a hyperlink, a form, or holds a reference to resources as images.  
It can be used to transmit data via the client. Since this header is client-side and under the application control, developers may assume that the Referer header can be used to reliably determine which URL generated a particular request.  

For example, developers may enable users to reset their passwords in case of need. This function may be accessible only coming from a specific link but, attakcers, can modify it and break the logic of the application because all that is client-side can be easily modified.  

The Referer header is strictly optional according to w3.org standards.

### Opaque Data

Sometimes, data transmitted via the client is encrypted or obfuscated.

## Capturing User Data: HTML Forms

HTML forms are used to capture users' input but can bring some security checks with them which can impose validation restrictions or perform validation checks on the input.  
These security measures can be easily bypassed leaving the application potentially vulnerable to attacks.  

### Length Limits

Sometimes forms can limit a field to contain a specific value (such as 1, 2, 3 ...) or hold no more than x times the value (such as 5, 10, 15 characters...). Intercepting the request and relaxing these limits may allow the attacker to bypass client-side lenght controls if the same checks are not implemented server-side.

### Script-based Validation

Other the buil-in HTML checks on forms, fine-grained controls are implemented using custom-script based on Javascript. They can be easily bypassed disabling Javascript in the browser but this may break parts of the application if JS is used to build and render pages, sections, and other elements.  
A more elegant way is to intercept the request and modify the values checked by the JS script.

### Disabled Elements

Sometimes, an attacker may encouter disabled form elements (`disabled="true"`) which are no longer used in the application's logic operations but the server-side may still process it. This may be an interesting point to leverage and analyze further.


## Handling Client-Side Data Securely

All data coming from a client is inherently untrustworthy.  

### Transmitting Data Via the Client

Developers should delegate clients with sending information only when they are forced to do so. It always a better choice to store data on the server and retrieves it when needed, maybe using special codes or remainders to link arguents from the client with data on the server.  

Encrypting data on the client-side can lead to dangerous situations because users might discover the encryption key used on the server (finding the data entry point where which uses encryption, and then ecnrypting harmful values in order to break the application), or replaying the attack over and over like sending encrypted modified values and buying items at lower prices.  

### Logging and Alerting

Administrators should receive alerts when a user is trying to actively cricumvent client-side controls. Those actions should also be logged.  
Applications put in place some initial step to defend theirselves such as blocking the account or dropping the connection.




