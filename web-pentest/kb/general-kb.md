## Cookies

Cookies are key-value pairs sent from the server and which the client uses to perform allowed actions on that server (cookies are sent with each request).

Cookies can be set for a parent domain (.example.com) and for subdomains (sub.example.com).
- Cookies set for a parent domain can be read by its child-domains (.example.com and sub.example.com)
- Cookies set for a subdomain can only be read by the subdomain and its subdomains (sub.example.com and subsub.sub.example.com)
- A subdomain can set cookies for its own subdomains, its parent but not for siblings domains (.example.com and sub.example.com and subsub.example.com but not sub2.example.com)

For security purposes the server may sent cookies along with two tags in the **Set-Cookie** header:
- **Secure**: cookies will be accessible only on HTTPS pages
- **HttpOnly**: cookies will not be readable by Javascript

________

## HTML

Browsers and Web-Application Firewalls and other pieces of software might parse HTML in different ways and where this happens, there well might be a vulnerability.

HTML5 introduced default behaviors to follow for browsers when parsing legacy HTML code, examples are:
- the **script** tag on its own will automatically be closed at the end of the page
-  a tag missing its closing angle bracket will automatically be closed by the angle bracket of the next tag on the page


________

## SOP (Same Origin Policy)

SOP is how the browser restricts a number of security-critical features:
- What domains can you contact via XMLHttpRequest
- Access the DOM across separate frames/windows

### Origin Matching

The way origin matching for SOP works is much more strict than cookies:
- Protocol must match otherwise meaning there is no crossing HTTP/HTTPS boundaries
- Port numbers must match
- Domain names must be and exact match meaning wildcards and subdomain walking are not allowed

It is possible for developers to loosen the grip that SOP has on their communications by changing document.domain, posting messages between windows and by using CORS (Cross-Origin Resource Sharing).
Every little change opens up new avenues for attack.


________

## CORS (Cross-Origin Resource Sharing)

CORS allows XMLHtppRequests outside the origin domain but with special headers.  
They even support sending and retrieval of cookies (going up to the remote server).

________

## CSRF (Cross-Site Request Forgery)

CRSF is when an attacker tricks a victim into going to a page controlled by the attacker, which then submits data to the target site _as_ the victim.  

CSRF tokens are randomnly generated and tied to users' sessions in order to prevent POST requests coming from unauthorized users (both logged-in and not logged-in).

Missing CSRF tokens in forms, of any kind, is to be considered a vulnerability, meaning a finding.

________

## XSS (Cross-Site Scripting)

The different types of XSS are:
- Reflected XSS: input from a user is directly returned to the browser, permitting injection of arbitrary content
- Stored XSS (or persistent): input from a user is stored on the server (often in a database) and returned later without proper escaping
- DOM XSS: input from a user is inserted in the page's DOM withou proper handling, enabling insertion of arbitrary nodes

________

## XXE (XML External Entity)

XML external entity injection (also known as XXE) is a web security vulnerability that allows an attacker to interfere with an application's processing of XML data.  
It often allows an attacker to view files on the application server filesystem, and to interact with any back-end or external systems that the application itself can access.  

### What are XML entities?

XML entities are a way of representing an item of data within an XML document, instead of using the data itself.  
Various entities are built in to the specification of the XML language. For example, the entities \&lt; and \&gt; represent the characters < and >.  
These are metacharacters used to denote XML tags, and so must generally be represented using their entities when they appear within data.

### What is document type definition?

The XML document type definition (DTD) contains declarations that can define the structure of an XML document, the types of data values it can contain, and other items.  
The DTD is declared within the optional DOCTYPE element at the start of the XML document.  
The DTD can be fully self-contained within the document itself (known as an "internal DTD") or can be loaded from elsewhere (known as an "external DTD") or can be hybrid of the two.

### What are XML custom entities?

XML allows custom entities to be defined within the DTD. For example:

```<!DOCTYPE foo [ <!ENTITY myentity "my entity value" > ]>```    

This definition means that any usage of the entity reference &myentity; within the XML document will be replaced with the defined value: "my entity value".

### What are XML external entities?

XML external entities are a type of custom entity whose definition is located outside of the DTD where they are declared.

The declaration of an external entity uses the SYSTEM keyword and must specify a URL from which the value of the entity should be loaded. For example:
  
```<!DOCTYPE foo [ <!ENTITY ext SYSTEM "http://normal-website.com" > ]>  ```

The URL can use the file:// protocol, and so external entities can be loaded from file. For example:

```<!DOCTYPE foo [ <!ENTITY ext SYSTEM "file:///path/to/file" > ]> ```

XML external entities provide the primary means by which XML external entity attacks arise.