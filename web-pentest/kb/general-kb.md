## HTML

Browsers and Web-Application Firewalls and other pieces of software might parse HTML in different ways and where this happens, there well might be a vulnerability.

HTML5 introduced default behaviors to follow for browsers when parsing legacy HTML code, examples are:
- the **script** tag on its own will automatically be closed at the end of the page
-  a tag missing its closing angle bracket will automatically be closed by the angle bracket of the next tag on the page


________

## SOP (Same-Origin Policy)

SOP is how the browser restricts a number of security-critical features:
- What domains can you contact via XMLHttpRequest
- Access the DOM across separate frames/windows

Some key features of Same-Origin Policy are:
- A page residing on one domain can cause and arbitrary request to be made to another domain (for example, by submitting a form or loading an image). But it cannot itself process tha data returned from that request.
- A page residing on one domain can load a script from another domain and execute this within its context. This is because scripts are assumed to contain code, rather than data, so cross-domain access should not lead to disclosure of any sensitive information.
- A page residing on one domain cannot read or modify the cookies or other DOM data belonging to another domain.

It prevents web applications from reading responses to requests between them.  
It does not prevent writing but reading.

### Origin Matching

The way origin matching for SOP works is much more strict than cookies:
- Protocol must match otherwise meaning there is no crossing HTTP/HTTPS boundaries
- Port numbers must match
- Domain names must be and exact match meaning wildcards and subdomain walking are not allowed

It is possible for developers to loosen the grip that SOP has on their communications by changing document.domain, posting messages between windows and by using CORS (Cross-Origin Resource Sharing).
Every little change opens up new avenues for attack.


________


## Attacking Authentication

### Bad Passwords

Applications should never allow:

- Very short or blank passwords
- Common dictionary words or names
- The same as the username
- Default value

### Verbose Failure Messages

Verbose failure messages such as "username not valid" in authentication form increase the attention drawn from attackers because thi level of verbosity is useful in enumerating existing users. From there, once valid usernames are found, attackers can proceed to enumerate passwords. 

Sometimes error messages may not give away hints about possible enumeration so easily. Sometimes are small details hidden in the HTML code ore somewhere else in the response that, when compared with other responses (such as right username and wrong password against wrong username and wrong password) may reveal important clues.

Even if there is no difference between responses, there may be a chance to detect when a username is valid. When a username is valid, some back-end processes is perfomed by the server to run the password check algorithm or retrieval of user-related information. This subtle difference in the response time is captured by intercepting programs.

### Password Change Functionality

Password change functionalities are extremely important to increase the overall usability of a web application but can embed security vulnerabilities:

- provide a verbose error message indicating whether the requested username is valid
- allow unrestricted guesses of the "existing password" field
- check whether the "new password" and "confirm new password" fields have the same value only after validating the existing password, thereby allowing an attacker to succeed in discovering the existing password noninvasively

### Forgotten Password Functionality

As for _Password Change Functionality_ there are several vulnerablities to keep in mind:

- enumeration of security questions, attackers can haverst them using a scripting attack and later decides which are the weakest
- unlimited attempts at revocery the password
- drop the user in an authenticated session after completion of a challenge, granting the attacker access to the user session even without knowing the password,
- let the user user specify the email to which receive the URL for password recovery  

**Application may not present this on-screen, but sometimes the e-mail is passed as hidden parameter or in cookies**

### "Remember Me" Functionality

_Remember Me_ functions are insecure by design due to the high chance of leave users's session data available (and vulnerable to attack) for a period of time that may well exceeds the actual time needed by the user.  

Implementations of this function may be exploitable because simple cookies (such as "RememberUser=abc") are in use which are vulnerable to guessing or enumeration and act as a sole mean of authentication, or more in general because they are not so-well protected.  
(Not all implementations are weak nor vulnerable to attacks).

### Incomplete Validation of Credentials

Some web applications may alter the user supplied password during account registration. This means that applications may truncate the password or turn it into lowercase or strip some special character.  

It may be a good idea to test variations of a known password to check if it is accepted truncated, all lowercase or uppercase, without some special characters (if any).  

### Insecure Distribution of Credentials

Web applications may send remainders of credentials to users (sometimes full login credentials aka login+password) through insecure means.  
In can even happen that these credentials does not expire and the user is not prompt to change the password after the first log-in.  

Sometimes, web applications send URLs to activate accounts which let users decide their first password. If these URLs do share a common pattern, an attacker may infer the pattern and craft URLs to attack other accounts.  

## Implementation Flaws in Authentication

### Fail-Open Login Mechanisms

A Fail-Open Login occurs when a multi-layered piece of code fails to properly handle unexpected data and partially log-in the user, meaning the user has access to some areas of the application but it is not associated to a session on the server.  

