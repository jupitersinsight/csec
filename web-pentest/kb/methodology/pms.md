
1. Mapping the application
2. Analyze the application

|Application logic|Access Handling|Input Handling|Application Hosting|
|----------|--------|-------|------|
|Test client side controls|Test authentication |Fuzzing parameter |Test web server |
|Test logic flaws|Test session management | Test for specific functions|Information leakage |
|  |Test access controls |
  


## Mapping the application

- Proxy - Spidering (ZAP, Burp)
- Browse entire application in the normal way, visiting every link, URL, form with JS either enabled and disabled
- Consult public resources: wayback machine, goole dorks, email on website (might lead to find repos/projects with major clues or useful information)
- Discover hidden content: ffuf, disearch, discovery (Burp), review client-side controls to identify any kind of hidden endpoint, parameter
- Request the server root directory, change hostanme with IP (may bypass filters)

## Analyze the Application

- Identify the functionality
- Identify entry points
- Identify technologies

Identify the core functionality the application was built around. Identify core mechanisms and their support functions such as user-registration, account recovery...

Identify all the different hypothetical entry points for introducing user input into the application: URL, POST data, cookies, HTTP headers, endpoint

Check HTTP Server header, it may contain info about software and framework in use.  

Mapping the attack surface.

**Test authentication mechanism**  

- Test password quality: quality rules used for username/password
- Test for username enumeration: identify authentication function where a username can be submitted and retrace any kind of information
- Test for password guessing
- Account recovery options: identify any kind of function that can recover the password/credentials. Understand how the function works using a test account that you control
- Test for username uniqueness: register the same username with different passwords
- Test autogenerated passwords from functions to determine weak spots in the algorithm

**Test for input-based vulnerabilities**

- SQL Injection
- XSS
- OS Command Injection
- Path Traversal
- File Inclusion

Fuzzing all the parameters of the application: URL query strings, params in the request body, HTTP cookies.  

Test for SQLi:  
- single quote for error or other anomalous behavior
- wildcard SQL Injection (% means wildcard in SQl)
- concatenator function to build strings
- always URL-encode chars such as + and whitespaces
- fingerprint the database using specific SQL syntax
- use UNION operator

**Testing XSS**  

Types: reflected, stored and DOM  

- always look for DOM API of the Web Application:
    - document.location, windows.location, document.url...
- identify reflection of user input
- bearing signature-based filter -> encode, key, confirm, eval, prompt

```