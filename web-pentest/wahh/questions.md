Answers can be found at http://mdsec.net/wahh


## Chapter 2 - Core Defense Mechanisms
___

**Question #1**

_Why are an application's mechanisms for handling user access only as strong as the weakest of these components?_

**Answer**

Application's mechanisms for handling user access share a tight bond between them.  

They are usually identified as _Authentication_, _Session Management_ and _Access Controls_.

If _Authentication_ is not strong enough, attackers may simply brute-force it and gain access as administrative user. Once logged-in as administrators they can maintain their session active as long as the session token expires and perform whatever administrative actions the access controls allow them to.

If _Session Management_ is not properly implemented and handled, attackers may steal other users' session tokens and impersonate them. In case attackers take over administrators sessions they are already authenticated and can perform administrative actions.

If _Access Controls_ are not properly implemented or are not effective, attackers may access administrative interfaces or reserved areas and/or perform actions that should be disallowed.

The compromise of one of the three mechanisms bypass the other two entirely.

___

**Question #2**

_What is the difference between a session and a session token?_

**Answer**

Authenticated users and guests both establish sessions between their browser and the web application.  
In order to keep tracks of these sessions, web applications make use of session tokens which help in delivering the correct response to the right user and avoid mistakes (e.g. deliver response to a wrong user).

___

**Question #3**

_Why is it not always possible to use a whitelist-based approach to input validation?_

**Answer**

Taking as example IT forums where users are supposed to share code, blocking it will be of no use to the users. In this case the web application is to accept unstrusted input and use secure procedures to safely store it on the server, maybe on a dedicated server where no other critical applications, like databases, are running or in use.

___

**Question #4**

_You are attacking an application that implements an administrative function. You do not have any valid credentials to use the function. Why should you nevertheless pay close attention to it?_

**Answer**

Because the function may react to unexpected input in ways the developers never intended:
- It may have been through a less rigorous testing because the intended users are trusted;
- It may be weak in the authentication mechanism and be vulnerable to brute force;
- It may be vulnerable to XSS (store XSS) being this way a mean to attack administrators and steal sensitive information.

___

**Question #5**

_An input validation mechanism designed to block cross-site scripting attacks performs the following sequence of steps on an item of input:_

1. _Strip any ```<script>``` expressions that appear_.
2. _Truncate the input to 50 characters_.
3. _Remove any quotation marks within the input_.
4. _URL-decode the input_.
5. _If any items were deleted, return to Step 1_.

_Can you bypass this validation mechanism to smuggle the following data past it?_
```"><script>alert("foo")</script>```

**Answer**

The following payload should do the trick... ```%22%3E%3Cscript%3Ealert(%22foo%22)</script>```

Step 1 should not detect any ```<script>``` tag.  
Step 2 does nothing because the overall length of the payload is shorter than 50 characters.  
Step 3 should not detect any quotation marks.
Step 4 will URL-decode the input
Step 5 should not trigger a new run of the process because no item was removed