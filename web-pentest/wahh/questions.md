Answers can be found at http://mdsec.net/wahh

## Chapter 2 - Core Defense Mechanisms
___

**Question #1**

_Why are an application's mechanisms for handling user access only as strong as the weakest of these components?_

**Answer**

Application's mechanisms for handling user access share a tight bond between them.  

They are usually identified as _Authentication_, _Session Management_ and _Access Controls_.

If _Authentication_ is not strong enough, attackers may simply brute-force it and gain access as administrative user. Once logged-in as administrators they can maintain their session active as long as the session token expires and perform whatever administrative actions the access controls allow them to.

If _Session Management_ is not properly implemented and handled, attackers may steal other users' session tokens and impersonate them. In case attackers take over administrators sessions they are already authenticated and can perform administrative actions.

If _Access Controls_ are not properly implemented or are not effective, attackers may access administrative interfaces or reserved areas and/or perform actions that should be disallowed.

The compromise of one of the three mechanisms bypass the other two entirely.

___

**Question #2**

_What is the difference between a session and a session token?_

**Answer**

Authenticated users and guests both establish sessions between their browser and the web application.  
In order to keep tracks of these sessions, web applications make use of session tokens which help in delivering the correct response to the right user and avoid mistakes (e.g. deliver response to a wrong user).

___

**Question #3**

_Why is it not always possible to use a whitelist-based approach to input validation?_

**Answer**

Taking as example IT forums where users are supposed to share code, blocking it will be of no use to the users. In this case the web application is to accept unstrusted input and use secure procedures to safely store it on the server, maybe on a dedicated server where no other critical applications, like databases, are running or in use.

___

**Question #4**

_You are attacking an application that implements an administrative function. You do not have any valid credentials to use the function. Why should you nevertheless pay close attention to it?_

**Answer**

Because the function may react to unexpected input in ways the developers never intended:
- It may have been through a less rigorous testing because the intended users are trusted;
- It may be weak in the authentication mechanism and be vulnerable to brute force;
- It may be vulnerable to XSS (store XSS) being this way a mean to attack administrators and steal sensitive information.

___

**Question #5**

_An input validation mechanism designed to block cross-site scripting attacks performs the following sequence of steps on an item of input:_

1. _Strip any ```<script>``` expressions that appear_.
2. _Truncate the input to 50 characters_.
3. _Remove any quotation marks within the input_.
4. _URL-decode the input_.
5. _If any items were deleted, return to Step 1_.

_Can you bypass this validation mechanism to smuggle the following data past it?_
```"><script>alert("foo")</script>```

**Answer**

The following payload should do the trick... ```%22%3E%3Cscript%3Ealert(%22foo%22)</script>```

Step 1 should not detect any ```<script>``` tag.  
Step 2 does nothing because the overall length of the payload is shorter than 50 characters.  
Step 3 should not detect any quotation marks.
Step 4 will URL-decode the input
Step 5 should not trigger a new run of the process because no item was removed

___

## Chapter 3 - Web Application Technologies

___

**Question #1**

_What is the `OPTIONS` method used for?_

**Answer**

The `OPTIONS` method is used to query the remote web server about supported HTTP methods for a specific resource which are returned in the response.

___

**Question #2**

_What are the `If-Modified-Since` and `If-None-Match` headers used for?_  
x_Why might you be interested in these when attacking an application?_

**Answer**

When a web application allows clients to store cached data about a requested resource, the client will inform the web application about it in requests to come.  

The `If-Modified-Since` header is used to inform the web server when the client accessed the requested resource last time. If the cached copy is still valid the server responds the client's request with a 304 status code.

The `If-None-Match` header contains an entity tag issued by the server to the client. The entity tag is per resource and determines whether the client may use its cached copy of it or not.

___

**Question #3**

_What is the significance of the `secure` flag when a server sets a cookie?_

**Answer**

The flag `secure` means that the cookie must be transmitted only over HTTPS communications to prevent MiTM-style attack against cookies.

___

**Question #4**

_What is the difference between the common status codes 301 and 302_

**Answer**

Status code 301 means that the requestes resource is no longer available at the requested path and has been _Moved Permanently_ to another URL, specified in the _Location_ header. The client must use the new URL in subsequent requests.

Status code 302 means that the requestes resource is found and the web application triggers a redirection to another path. The client must use the original URL in sebsequent requests.

___

**Question #5**

_How does a browser interoperate with a web proxy when SSL is being used?_

**Answer**

The client browser cannot perform a SSL handshake with the proxy server because it would break the secure channel. Instead, it sends a `CONNECT` request to the proxy over HTTP with destination's hostname and port. If the proxy server allows the communication to pass, it responds with a status code 200. The client browser performs the SSL handshake with the intended destination and the proxy server acts a pure TCP-level relay letting packets to flow in both directions.

